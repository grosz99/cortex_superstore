version: 1
model:
  name: SuperstoreModel
  description: Semantic model for Superstore retail data analysis
  documentation: |
    This semantic model represents a retail superstore business with three main entities:
    1. Orders - Contains sales transactions with product, customer, and financial details
    2. Customers - Contains customer relationship information and contact details
    3. Products - Contains product specifications and attributes
    
    Common business questions include sales analysis by region, customer segment analysis,
    product performance metrics, and profitability trends over time.
  tables:
    - name: Orders
      description: Main sales and order data for the Superstore
      schema: data
      database: SuperstoreDB
      columns:
        - name: Order_ID
          description: Unique identifier for each order
          primaryKey: true
        - name: Order_Date
          description: Date when the order was placed
          type: date
        - name: Ship_Date
          description: Date when the order was shipped
          type: date
        - name: Ship_Mode
          description: Shipping mode for the order (Standard, Express, etc.)
        - name: Customer_ID
          description: Unique identifier for the customer
        - name: Customer_Name
          description: Name of the customer
        - name: Segment
          description: Customer segment (Consumer, Corporate, Home Office)
        - name: Country
          description: Country where the order was placed
        - name: City
          description: City where the order was placed
        - name: State
          description: State where the order was placed
        - name: Postal_Code
          description: Postal code of the delivery address
        - name: Region
          description: Geographic region (East, West, Central, South)
        - name: Product_ID
          description: Unique identifier for the product
        - name: Category
          description: Product category (Furniture, Office Supplies, Technology)
        - name: Sub_Category
          description: Product sub-category
        - name: Product_Name
          description: Name of the product
        - name: Sales
          description: Total sales amount for the order line
          type: number
        - name: Quantity
          description: Quantity of products ordered
          type: number
        - name: Discount
          description: Discount applied to the order line
          type: number
        - name: Profit
          description: Profit generated from the order line
          type: number

    - name: Customers
      description: Customer relationship management data
      schema: data
      database: SuperstoreDB
      columns:
        - name: Customer_ID
          description: Unique identifier for the customer
          primaryKey: true
        - name: Customer_Since
          description: Date when the customer was first registered
          type: date
        - name: Email
          description: Customer's email address
        - name: Phone
          description: Customer's phone number
        - name: Customer_Tier
          description: Customer loyalty tier (Gold, Silver, Bronze)
        - name: Account_Manager
          description: Name of the account manager for the customer

    - name: Products
      description: Product details and specifications
      schema: data
      database: SuperstoreDB
      columns:
        - name: Product_ID
          description: Unique identifier for the product
          primaryKey: true
        - name: Brand
          description: Brand name of the product
        - name: Warranty_Years
          description: Number of years of warranty
          type: number
        - name: Material
          description: Material used in the product
        - name: Release_Date
          description: Date when the product was released
          type: date
        - name: Sustainability_Rating
          description: Environmental sustainability rating (A, B, C, D)

  relationships:
    - name: Orders_to_Customers
      description: Relationship between orders and customers - each order belongs to a specific customer
      from:
        table: Orders
        column: Customer_ID
      to:
        table: Customers
        column: Customer_ID
      cardinality: MANY_TO_ONE
      joinType: INNER

    - name: Orders_to_Products
      description: Relationship between orders and products - each order line contains a specific product
      from:
        table: Orders
        column: Product_ID
      to:
        table: Products
        column: Product_ID
      cardinality: MANY_TO_ONE
      joinType: INNER
      
    - name: Customer_Region_Analysis
      description: Relationship for analyzing customer orders by geographic region
      from:
        table: Orders
        column: Region
      to:
        table: Orders
        column: Customer_ID
      cardinality: ONE_TO_MANY
      joinType: INNER
      
    - name: Product_Category_Analysis
      description: Relationship for analyzing product performance by category
      from:
        table: Orders
        column: Category
      to:
        table: Orders
        column: Product_ID
      cardinality: ONE_TO_MANY
      joinType: INNER

  metrics:
    - name: Total_Sales
      description: Sum of all sales
      expression: SUM(Orders.Sales)

    - name: Total_Profit
      description: Sum of all profit
      expression: SUM(Orders.Profit)

    - name: Profit_Margin
      description: Profit as a percentage of sales
      expression: SUM(Orders.Profit) / SUM(Orders.Sales) * 100

    - name: Average_Order_Value
      description: Average sales amount per order
      expression: AVG(Orders.Sales)

  dimensions:
    - name: Order_Date
      description: Date dimension for order analysis
      table: Orders
      column: Order_Date
      type: time
      timeGranularities: [DAY, WEEK, MONTH, QUARTER, YEAR]

    - name: Ship_Date
      description: Date dimension for shipping analysis
      table: Orders
      column: Ship_Date
      type: time
      timeGranularities: [DAY, WEEK, MONTH, QUARTER, YEAR]

    - name: Region
      description: Geographic region dimension
      table: Orders
      column: Region

    - name: Category
      description: Product category dimension
      table: Orders
      column: Category

  customInstructions: |
    This semantic model represents a retail superstore dataset with orders, customers, and products.
    - Use "Sales" for revenue or sales amount
    - Use "Profit" for profit amount
    - "Customer_Tier" represents the loyalty level (Gold, Silver, Bronze)
    - "Sustainability_Rating" represents environmental rating (A is best, D is worst)
    - When analyzing sales trends, use Order_Date rather than Ship_Date
    - For regional analysis, use the Region field rather than individual State/City fields
    - Customer segments are Consumer, Corporate, and Home Office
    - Product categories are Furniture, Office Supplies, and Technology
    
  verifiedQueries:
    - name: total_sales_by_region
      description: Total sales broken down by region
      question: What are the total sales by region?
      query: |
        SELECT Region, SUM(Sales) as Total_Sales
        FROM SuperstoreDB.data.Orders
        GROUP BY Region
        ORDER BY Total_Sales DESC
        
    - name: profit_by_category
      description: Profit analysis by product category
      question: Show me profit by product category
      query: |
        SELECT Category, SUM(Profit) as Total_Profit
        FROM SuperstoreDB.data.Orders
        GROUP BY Category
        ORDER BY Total_Profit DESC
        
    - name: top_customers
      description: Top customers by sales amount
      question: Who are our top 10 customers by sales?
      query: |
        SELECT Customer_Name, SUM(Sales) as Total_Sales
        FROM SuperstoreDB.data.Orders
        GROUP BY Customer_Name
        ORDER BY Total_Sales DESC
        LIMIT 10
        
    - name: sales_trend_monthly
      description: Monthly sales trend analysis
      question: Show monthly sales trend for the past year
      query: |
        SELECT DATE_TRUNC('MONTH', Order_Date) as Month, SUM(Sales) as Monthly_Sales
        FROM SuperstoreDB.data.Orders
        WHERE Order_Date >= DATEADD(YEAR, -1, CURRENT_DATE())
        GROUP BY Month
        ORDER BY Month
        
    - name: product_profitability
      description: Product profitability analysis
      question: Which products have the highest profit margin?
      query: |
        SELECT Product_Name, SUM(Sales) as Total_Sales, SUM(Profit) as Total_Profit, 
               (SUM(Profit)/SUM(Sales))*100 as Profit_Margin
        FROM SuperstoreDB.data.Orders
        GROUP BY Product_Name
        HAVING Total_Sales > 0
        ORDER BY Profit_Margin DESC
        LIMIT 20
        
    - name: customer_segment_analysis
      description: Analysis of sales by customer segment
      question: Compare sales and profit across different customer segments
      query: |
        SELECT Segment, SUM(Sales) as Total_Sales, SUM(Profit) as Total_Profit,
               COUNT(DISTINCT Order_ID) as Order_Count
        FROM SuperstoreDB.data.Orders
        GROUP BY Segment
        ORDER BY Total_Sales DESC
        
    - name: gold_tier_customers
      description: Analysis of Gold tier customers
      question: How much sales come from Gold tier customers?
      query: |
        SELECT c.Customer_Tier, SUM(o.Sales) as Total_Sales, COUNT(DISTINCT o.Customer_ID) as Customer_Count
        FROM SuperstoreDB.data.Orders o
        JOIN SuperstoreDB.data.Customers c ON o.Customer_ID = c.Customer_ID
        WHERE c.Customer_Tier = 'Gold'
        GROUP BY c.Customer_Tier
